{
  "permissions": {
    "allow": [
      "Bash(GIT_SSH_COMMAND=\"ssh -i ~/.ssh/claude-code-gh\" git push origin main)",
      "Bash(git rev-parse:*)",
      "Bash(echo $GITHUB_TOKEN)",
      "Bash(docker login:*)",
      "Bash(gh api:*)",
      "Bash(gh auth:*)",
      "Bash(git add:*)",
      "Bash(git commit:*)",
      "Bash(gh run list:*)",
      "Bash(gh run watch:*)",
      "Bash(pulumi config get:*)",
      "Bash(pulumi stack output:*)",
      "Bash(pulumi config set:*)",
      "Bash(./scripts/egress-smoke.sh:*)",
      "Bash(export KUBECONFIG=~/.kube/k3s-warp.yaml)",
      "Bash(kubectl:*)",
      "Bash(export KUBECONFIG=~/.kube/k3s-tethys-public.yaml)",
      "Bash(xargs:*)",
      "Bash(sshpass -p \"TaylorRules\" ssh -o StrictHostKeyChecking=no root@157.173.210.123 'kubectl -n apps logs -l app=project-bootstrapper --tail=50 | grep -E \"\"webhook|Poll|Found\"\"')",
      "Bash(sshpass -p \"TaylorRules\" ssh -o StrictHostKeyChecking=no root@157.173.210.123 'kubectl -n apps get pods -l app=project-bootstrapper')",
      "Bash(sshpass -p \"TaylorRules\" ssh -o StrictHostKeyChecking=no root@157.173.210.123 \"kubectl -n apps logs project-bootstrapper-855966c48f-25n2b --tail=100\")",
      "Bash(sshpass -p \"TaylorRules\" ssh -o StrictHostKeyChecking=no root@157.173.210.123 \"kubectl -n apps logs project-bootstrapper-855966c48f-25n2b --tail=500 --since=15m\")",
      "Bash(sshpass -p \"TaylorRules\" ssh -o StrictHostKeyChecking=no root@157.173.210.123 'kubectl -n apps logs -l app=csv-ingestion-worker --tail=50 | grep -E \"\"Processing|Inserted|Error\"\"')",
      "Bash(sshpass -p \"TaylorRules\" ssh -o StrictHostKeyChecking=no root@157.173.210.123 'kubectl -n apps logs -l app=annotation-sink --tail=100 | grep -E \"\"webhook|POST|annotation\"\"')",
      "Bash(sshpass -p \"TaylorRules\" ssh -o StrictHostKeyChecking=no root@157.173.210.123 'kubectl -n apps get deployments')",
      "Bash(sshpass -p \"TaylorRules\" ssh -o StrictHostKeyChecking=no root@157.173.210.123 'kubectl -n apps get svc')",
      "Bash(sshpass -p \"TaylorRules\" ssh -o StrictHostKeyChecking=no root@157.173.210.123 'kubectl -n apps logs deploy/annotations-sink --tail=100')",
      "Bash(sshpass -p \"TaylorRules\" ssh -o StrictHostKeyChecking=no root@157.173.210.123 'kubectl -n apps logs deploy/csv-ingestion-worker-deployment-16729817 --tail=100')",
      "WebSearch",
      "WebFetch(domain:github.com)",
      "Bash(sshpass -p \"TaylorRules\" ssh -o StrictHostKeyChecking=no root@157.173.210.123 'kubectl -n apps exec deploy/ls-triton-adapter -- env | grep TRITON')",
      "Bash(go build:*)",
      "Bash(go mod:*)",
      "Bash(go list:*)",
      "Bash(go vet:*)",
      "Bash(go test:*)",
      "Bash(chmod:*)",
      "Bash(./integration_test.sh:*)",
      "Bash(sshpass -p 'C0w5in$pace' ssh -o StrictHostKeyChecking=no neptune@192.168.2.110 'curl -s http://localhost:8000/v2/health/ready')",
      "Bash(sshpass -p 'C0w5in$pace' ssh -o StrictHostKeyChecking=no neptune@192.168.2.110 'docker ps | grep triton')",
      "Bash(sshpass -p 'C0w5in$pace' ssh -o StrictHostKeyChecking=no neptune@192.168.2.110 'docker port triton-server')",
      "Bash(sshpass -p 'C0w5in$pace' ssh -o StrictHostKeyChecking=no neptune@192.168.2.110 'docker inspect triton-server | grep -A 20 \"\"NetworkSettings\"\"')",
      "Bash(sshpass -p 'C0w5in$pace' ssh -o StrictHostKeyChecking=no neptune@192.168.2.110 'netstat -tlnp 2>/dev/null | grep :8000 || ss -tlnp 2>/dev/null | grep :8000 || echo \"\"Port 8000 not found\"\"')",
      "Bash(curl:*)",
      "Bash(tee:*)",
      "Bash(sshpass -p 'C0w5in$pace' ssh -o StrictHostKeyChecking=no neptune@192.168.2.110 'cat /models/distilbert/config.pbtxt 2>/dev/null || echo \"\"Config file not found\"\"')",
      "Read(//Users/rt/.kube/**)",
      "Bash(/opt/homebrew/Caskroom/miniconda/base/bin/python generate_synthetic_data.py --sample 10 --output-dir data/)",
      "Bash(/opt/homebrew/Caskroom/miniconda/base/bin/python generate_synthetic_data.py --input sample_tasks.json --output-dir data/)",
      "Bash(warp-cli status:*)",
      "Bash(./export_label_studio_tasks.sh:*)",
      "Bash(cat:*)",
      "Bash(gzip:*)",
      "Bash(/opt/homebrew/Caskroom/miniconda/base/bin/python generate_synthetic_data.py --input label_studio_tasks.json --output-dir data/)",
      "Read(//private/tmp/**)",
      "Bash(jq:*)",
      "Bash(/opt/homebrew/Caskroom/miniconda/base/bin/python -c \"import transformers; print(''transformers version:'', transformers.__version__)\")",
      "Bash(env)",
      "Read(//Users/rt/dotfiles/terminal/**)",
      "Bash(/opt/homebrew/Caskroom/miniconda/base/bin/pip install seqeval)",
      "Read(//Users/rt/**)",
      "Bash(kill:*)",
      "Bash(/opt/homebrew/Caskroom/miniconda/base/bin/python export_onnx.py --model models/ner-distilbert --output models/ner-distilbert-onnx)",
      "Bash(/opt/homebrew/Caskroom/miniconda/base/bin/pip install 'optimum[exporters]==1.21.0')",
      "Bash(/opt/homebrew/Caskroom/miniconda/base/bin/pip list)",
      "Bash(/opt/homebrew/Caskroom/miniconda/base/bin/pip install onnx onnxruntime)",
      "Bash(sshpass -p 'C0w5in$pace' ssh -o StrictHostKeyChecking=no neptune@192.168.2.110 'ls -la /models/')",
      "Bash(sshpass -p 'C0w5in$pace' ssh -o StrictHostKeyChecking=no neptune@192.168.2.110 'mkdir -p /models/ner-distilbert/1')",
      "Bash(sshpass -p 'C0w5in$pace' scp -o StrictHostKeyChecking=no model.onnx neptune@192.168.2.110:/models/ner-distilbert/1/)",
      "Bash(sshpass -p 'C0w5in$pace' scp -o StrictHostKeyChecking=no *.json *.txt neptune@192.168.2.110:/models/ner-distilbert/)",
      "Bash(sshpass -p 'C0w5in$pace' scp -o StrictHostKeyChecking=no /tmp/ner-triton-config.pbtxt neptune@192.168.2.110:/models/ner-distilbert/config.pbtxt)",
      "Bash(sshpass -p 'C0w5in$pace' ssh -o StrictHostKeyChecking=no neptune@192.168.2.110 'ls -lh /models/ner-distilbert/')",
      "Bash(sshpass -p 'C0w5in$pace' ssh -o StrictHostKeyChecking=no neptune@192.168.2.110 'ls -lh /models/ner-distilbert/1/')",
      "Bash(sshpass -p 'C0w5in$pace' ssh -o StrictHostKeyChecking=no neptune@192.168.2.110 'docker exec triton-server tritonserver --model-control-mode=poll --model-repository=/models')",
      "Bash(sshpass -p 'C0w5in$pace' ssh -o StrictHostKeyChecking=no neptune@192.168.2.110 'docker restart triton-server')",
      "Bash(sshpass -p 'C0w5in$pace' ssh -o StrictHostKeyChecking=no neptune@192.168.2.110 'docker logs triton-server 2>&1 | grep -A 5 -B 5 \"\"ner-distilbert\"\"')",
      "Bash(sshpass -p 'C0w5in$pace' ssh -o StrictHostKeyChecking=no neptune@192.168.2.110 'docker inspect triton-server | grep -A 10 Cmd')",
      "Bash(sshpass -p 'C0w5in$pace' ssh -o StrictHostKeyChecking=no neptune@192.168.2.110 'ls -la /models/ner-distilbert/')",
      "Bash(sshpass -p 'C0w5in$pace' ssh -o StrictHostKeyChecking=no neptune@192.168.2.110 'cat /models/ner-distilbert/config.pbtxt')",
      "Bash(sshpass -p 'C0w5in$pace' ssh -o StrictHostKeyChecking=no neptune@192.168.2.110 'docker inspect triton-server | grep -A 20 Mounts')",
      "Bash(sshpass -p 'C0w5in$pace' ssh -o StrictHostKeyChecking=no neptune@192.168.2.110 'ls -la /home/neptune/triton-models/')",
      "Bash(sshpass -p 'C0w5in$pace' ssh -o StrictHostKeyChecking=no neptune@192.168.2.110 'mv /models/ner-distilbert /home/neptune/triton-models/')",
      "Bash(sshpass:*)",
      "Bash(doc-extract:*)",
      "Bash(/opt/homebrew/Caskroom/miniconda/base/bin/python --version)",
      "Bash(docker build:*)",
      "Bash(find:*)",
      "Bash(go get:*)",
      "Bash(git reset:*)",
      "Bash(docker buildx:*)",
      "Bash(gh run view:*)",
      "Bash(pulumi stack:*)",
      "Bash(gh pr list:*)",
      "Bash(gh pr view:*)",
      "Bash(gh pr checks:*)",
      "Bash(gh issue create:*)",
      "Bash(gh label:*)",
      "Bash(gh pr comment:*)",
      "Bash(docker run:*)",
      "Bash(gh pr merge:*)",
      "Bash(git pull:*)",
      "Bash(gh workflow run:*)",
      "Bash(gh issue list:*)",
      "Bash(gh issue edit:*)",
      "Bash(gh variable set:*)",
      "Bash(gh issue comment 170 --body \"$(cat <<''EOF''\n## Plan: Finalize ORT backend config for Calypso\n\n**Actions:**\n1. Validate ORT backend config for GPU:\n   - Remove TensorRT accelerator block (ORT backend doesn''t use TensorRT)\n   - Keep `instance_group` `KIND_GPU` \n   - Maintain dynamic batching as-is\n2. Load `ner-distilbert` model repository on Calypso\n3. Verify `/v2/models/ner-distilbert/ready` endpoint returns true\n4. Run single inference smoke test\n\n**Acceptance:**\n- ✅ `config.pbtxt` checked into repo\n- ✅ Triton ready endpoint returns `ready=true`\n- ✅ Single inference smoke test passes\n\n**Risk mitigation:**\n- Keep existing config.pbtxt as backup before modifications\n- Test on Calypso isolated from production traffic first\nEOF\n)\")",
      "Bash(gh issue comment 166 --body \"$(cat <<''EOF''\n## Plan: Enforce consistent label order and add unit test\n\n**Actions:**\n1. Add unit test to assert adapter labels match trainer configuration:\n   - Verify adapter labels == trainer `LABELS` \n   - Confirm `id2label` mapping used correctly in predictions\n2. Create test fixtures:\n   - Add `golden-labels.json` with expected label configuration\n   - Include tiny logits fixture for deterministic testing\n3. CI integration:\n   - Test must fail on label mismatch\n   - Add to existing test suite\n\n**Acceptance:**\n- ✅ Unit test fails when labels are out of sync\n- ✅ CI passes with current label configuration\n- ✅ Test coverage for id2label mapping\n\n**Context:**\nEnsures Label Studio predictions maintain consistent label order with the trained model, preventing silent misclassification bugs.\nEOF\n)\")",
      "Bash(gh issue comment:*)",
      "Bash(gh variable:*)",
      "Bash(bash:*)",
      "Bash(ssh:*)",
      "Bash(scp:*)",
      "Bash(gh issue close 170 --comment \"$(cat <<''EOF''\n✅ **Complete - All acceptance criteria met**\n\n**Deployed ner-distilbert to Calypso Triton:**\n- Model: `/models/ner-distilbert/1/model.onnx` (254M)\n- Config: ORT backend, CUDAExecutionProvider, KIND_GPU\n- Supporting files: tokenizer, labels.json, vocab\n\n**Verification results:**\n```bash\n# Ready endpoint\ncurl http://localhost:8000/v2/models/ner-distilbert/ready\n# → HTTP 200 OK\n\n# Inference test\n# → ✅ Shape: [1, 16, 9], Datatype: FP32, Output: logits\n```\n\n**Triton logs confirm:**\n- `successfully loaded ''ner-distilbert''`\n- `TRITONBACKEND_ModelInstanceInitialize: ner-distilbert_0_0 (GPU device 0)`\n- `CUDAExecutionProvider` active on RTX 4090\n\n**Config committed:**\n- `apps/ner-training/config.pbtxt.template` in repo\n- No TensorRT accelerator (ORT incompatible)\n- Dynamic batching: preferred_batch_size [4, 8]\n\n**Next:** SME can now use Label Studio → adapter auto-connects → Triton inference on 4090\nEOF\n)\")"
    ],
    "deny": [],
    "ask": []
  }
}
